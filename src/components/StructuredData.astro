---
interface Props {
	type?: "restaurant" | "article" | "menu" | "breadcrumb" | "website";
	data?: any;
}

const { type = "restaurant", data = {} } = Astro.props;
const siteUrl = Astro.site?.toString() || "https://lacortedilaura.it";

// Dati base del ristorante
const restaurantBase = {
	"@context": "https://schema.org",
	"@type": "Restaurant",
	name: "La Corte di Laura",
	description:
		"Ristorante tradizionale italiano con cucina autentica e atmosphere accogliente",
	url: siteUrl,
	telephone: "+390583088818",
	mobilePhone: "+393296752634",
	email: "info@lacortedilaura.it",
	address: {
		"@type": "PostalAddress",
		streetAddress: "Via Nicola Dorati, 44",
		addressLocality: "Granaiola (Bagni di Lucca)",
		postalCode: "54027",
		addressCountry: "IT",
	},
	geo: {
		"@type": "GeoCoordinates",
		latitude: "44.0177436",
		longitude: "10.5726613",
	},
	servesCuisine: ["Italian", "Mediterranean"],
	priceRange: "$$",
	image: `${siteUrl}/favicon.png`,
	logo: `${siteUrl}/favicon.png`,
	sameAs: [
		"https://www.facebook.com/profile.php?id=61573481385415&locale=it_IT",
		"https://www.instagram.com/lacortedilaura",
	],
	openingHoursSpecification: [
		{
			"@type": "OpeningHoursSpecification",
			dayOfWeek: ["Sunday"],
			opens: "12:00",
			closes: "22:00",
		},
		{
			"@type": "OpeningHoursSpecification",
			dayOfWeek: ["Thursday", "Friday", "Saturday"],
			opens: "19:00",
			closes: "22:00",
		},
	],
	acceptsReservations: true,
};

let structuredData: any;

switch (type) {
	case "restaurant":
		structuredData = restaurantBase;
		break;
        
	case "website":
		structuredData = {
			"@context": "https://schema.org",
			"@type": "WebSite",
			name: "Ristorante - La Corte di Laura",
			url: siteUrl,
		};
		break;

	case "article":
		const lang = Astro.url.pathname.startsWith("/en/") ? "en" : "it";
		structuredData = {
			"@context": "https://schema.org",
			"@type": "Article",
			headline: data.title,
			description: data.description,
			image: data.image
				? `${siteUrl}${data.image}`
				: `${siteUrl}/favicon.png`,
			author: {
				"@type": "Person",
				name: data.author || "Laura",
			},
			publisher: {
				"@type": "Organization",
				name: "La Corte di Laura",
				logo: {
					"@type": "ImageObject",
					url: `${siteUrl}/favicon.png`,
				},
			},
			datePublished: data.publishedTime,
			dateModified: data.modifiedTime || data.publishedTime,
			mainEntityOfPage: {
				"@type": "WebPage",
				"@id": `${siteUrl}${Astro.url.pathname}`,
			},
			inLanguage: lang,
		};
		break;

	case "menu":
		structuredData = {
			"@context": "https://schema.org",
			"@type": "Menu",
			name: data.menuName || "Menu - La Corte di Laura",
			description:
				data.menuDescription || "Il nostro menu tradizionale italiano",
			hasMenuSection: data.menuSections || [],
		};
		break;

	case "breadcrumb":
		structuredData = {
			"@context": "https://schema.org",
			"@type": "BreadcrumbList",
			itemListElement:
				data.breadcrumbs?.map((crumb: any, index: number) => ({
					"@type": "ListItem",
					position: index + 1,
					name: crumb.name,
					item: `${siteUrl}${crumb.url}`,
				})) || [],
		};
		break;
}
---

{
	structuredData && (
		<script
			is:inline
			type="application/ld+json"
			set:html={JSON.stringify(structuredData)}
		/>
	)
}
