---
interface Props {
	type?: "localbusiness" | "article" | "breadcrumb" | "website";
	data?: any;
}

const { type = "localbusiness", data = {} } = Astro.props;
const siteUrl =
	Astro.site?.toString() || "https://artigianidelsalotto.marf.click";

// Dati base dell'attività
const businessBase = {
	"@context": "https://schema.org",
	"@type": "LocalBusiness",
	name: "Artigiani del Salotto",
	description: "Produttore artigianale di divani e poltrone di alta qualità.",
	url: siteUrl,
	telephone: "+39000000000", // Placeholder
	email: "info@artigianidelsalotto.it", // Placeholder
	address: {
		"@type": "PostalAddress",
		streetAddress: "TBD",
		addressLocality: "TBD",
		postalCode: "00000",
		addressCountry: "IT",
	},
	image: `${siteUrl}/favicon.png`,
	logo: `${siteUrl}/favicon.png`,
};

let structuredData: any;

switch (type) {
	case "localbusiness":
		structuredData = businessBase;
		break;

	case "website":
		structuredData = {
			"@context": "https://schema.org",
			"@type": "WebSite",
			name: "Artigiani del Salotto",
			url: siteUrl,
		};
		break;

	case "article":
		const lang = Astro.url.pathname.startsWith("/en/") ? "en" : "it";
		structuredData = {
			"@context": "https://schema.org",
			"@type": "Article",
			headline: data.title,
			description: data.description,
			image: data.image
				? `${siteUrl}${data.image}`
				: `${siteUrl}/favicon.png`,
			author: {
				"@type": "Person",
				name: data.author || "Artigiani del Salotto",
			},
			publisher: {
				"@type": "Organization",
				name: "Artigiani del Salotto",
				logo: {
					"@type": "ImageObject",
					url: `${siteUrl}/favicon.png`,
				},
			},
			datePublished: data.publishedTime,
			dateModified: data.modifiedTime || data.publishedTime,
			mainEntityOfPage: {
				"@type": "WebPage",
				"@id": `${siteUrl}${Astro.url.pathname}`,
			},
			inLanguage: lang,
		};
		break;

	case "breadcrumb":
		structuredData = {
			"@context": "https://schema.org",
			"@type": "BreadcrumbList",
			itemListElement:
				data.breadcrumbs?.map((crumb: any, index: number) => ({
					"@type": "ListItem",
					position: index + 1,
					name: crumb.name,
					item: `${siteUrl}${crumb.url}`,
				})) || [],
		};
		break;
}
---

{
	structuredData && (
		<script
			is:inline
			type="application/ld+json"
			set:html={JSON.stringify(structuredData)}
		/>
	)
}
